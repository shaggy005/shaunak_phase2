- day 1 was a simple reverse engineering challenge.
- weâ€™re given a static binary called check-list that reads 0x400 bytes from stdin,
- messes with each byte using a lot of add and sub instructions,
- and then compares the result with hardcoded values.
- if all comparisons pass, it prints the flag, otherwise it exits with an error message.

### first thing i did was disassemble the binary:
```
objdump -d check-list -M intel
```
- at the start, the program reads 0x400 bytes into a stack buffer at rbp-0x400.
-  after that, there are tons of instructions like:
```
add BYTE PTR [rbp-...], imm
sub BYTE PTR [rbp-...], imm
```
- each instruction only touches one byte, and there are no loops or mixing between bytes.
- later on, the binary performs exactly 0x400 cmp BYTE PTR [rbp-x], imm instructions.
- if any of these fail, it jumps to a block that prints an error message.
- if all succeed, it prints a success message and reads /flag.
- since everything is byte-wise and linear, this can be solved by inverting the math.

### first, i extracted all the comparison values directly from the binary:
```
objdump -d check-list -M intel \
| grep cmp \
| grep BYTE \
| awk -F, '{print $2}' \
| tr '\n' ',' \
| sed 's/,$//'
```
- this gives a list of 1024 constants, which are the expected final values of each byte.
- next, i wanted to see what the program does to a known input.
- i ran the binary under gdb using 'A' * 0x400 as input and broke at the first cmp instruction.
- at that point, the buffer already contains the fully obfuscated bytes, so i dumped it from memory:
```
dump binary memory /tmp/dump.bin $rbp-0x400 $rbp
```
- this dump corresponds to what happens when every input byte is 0x41.
- for each byte, the binary effectively does:
```
obfuscated[i] = input[i] + delta[i]
```
- from the dump, we know:
```
delta[i] = obfuscated[i] - 0x41
```
- and since the program checks:
```
obfuscated[i] == cmp_vals[i]
```
- we can recover the correct input byte using:
```
input[i] = 0x41 + cmp_vals[i] - obfuscated[i]
```
- i wrote a small python script to compute all 0x400 input bytes and save them to a file:
```
correct_input = [
    (0x41 + cmp_vals[i] - obfuscated[i]) & 0xff
    for i in range(0x400)
]
```
- finally, piping the generated bytes into the original binary gives the flag:
```
cat correct_input.bin | /challenge/check-list
```
## flag
```
pwn.college{oePJe2z3UCoV41PCODeBZ-b-tyq.0FO1gTMywSMwEzNzEzW}
```


and the program prints the success message followed by the flag.
